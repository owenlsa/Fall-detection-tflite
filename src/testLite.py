import numpy as np
import tensorflow as tf
import cv2

# Load TFLite model and allocate tensors.
interpreter = tf.lite.Interpreter(model_path="../model.tflite")
interpreter.allocate_tensors()

input_details = interpreter.get_input_details()
output_details = interpreter.get_output_details()

print(input_details)
print(output_details)

#input_data = np.loadtxt('../data/test.csv',delimiter=',')

#input_data = np.array([143.0,143.0,144.0,144.0,143.0,143.0,143.0,144.0,144.0,145.0,145.0,145.0,144.0,143.0,143.0,143.0,143.0,143.0,143.0,143.0,143.0,142.0,141.0,141.0,141.0,141.0,142.0,142.0,143.0,144.0,145.0,145.0,146.0,146.0,146.0,147.0,147.0,147.0,147.0,146.0,144.0,142.0,140.0,137.0,131.0,127.0,126.0,132.0,140.0,148.0,156.0,161.0,161.0,157.0,153.0,147.0,139.0,131.0,135.0,138.0,140.0,142.0,147.0,150.0,151.0,154.0,160.0,162.0,161.0,159.0,156.0,156.0,157.0,156.0,156.0,156.0,156.0,158.0,159.0,160.0,160.0,159.0,157.0,155.0,154.0,153.0,152.0,150.0,148.0,146.0,147.0,159.0,186.0,210.0,220.0,189.0,105.0,61.0,74.0,112.0,135.0,133.0,133.0,133.0,124.0,116.0,118.0,128.0,140.0,149.0,154.0,155.0,152.0,145.0,143.0,145.0,149.0,150.0,145.0,138.0,131.0,130.0,131.0,133.0,133.0,133.0,131.0,127.0,113.0,95.0,91.0,82.0,83.0,100.0,117.0,114.0,94.0,73.0,55.0,44.0,43.0,52.0,58.0,65.0,71.0,77.0,79.0,80.0,80.0,81.0,85.0,88.0,87.0,80.0,74.0,71.0,71.0,77.0,86.0,96.0,106.0,113.0,117.0,118.0,112.0,106.0,99.0,94.0,90.0,88.0,89.0,91.0,94.0,97.0,101.0,104.0,105.0,105.0,102.0,99.0,96.0,94.0,93.0,93.0,95.0,97.0,98.0,100.0,101.0,103.0,104.0,104.0,104.0,103.0,102.0,101.0,101.0,100.0,100.0,100.0,121.0,121.0,121.0,120.0,119.0,118.0,118.0,118.0,118.0,118.0,118.0,118.0,118.0,118.0,118.0,117.0,116.0,115.0,115.0,115.0,115.0,115.0,115.0,115.0,115.0,114.0,114.0,115.0,115.0,116.0,116.0,116.0,116.0,115.0,115.0,116.0,116.0,117.0,118.0,120.0,122.0,124.0,125.0,126.0,126.0,125.0,126.0,130.0,134.0,139.0,142.0,145.0,141.0,138.0,139.0,131.0,128.0,127.0,124.0,125.0,131.0,135.0,133.0,128.0,125.0,125.0,126.0,125.0,122.0,116.0,111.0,108.0,107.0,107.0,108.0,109.0,110.0,110.0,110.0,109.0,106.0,104.0,103.0,103.0,104.0,106.0,107.0,108.0,109.0,109.0,106.0,104.0,102.0,109.0,140.0,125.0,88.0,58.0,79.0,95.0,96.0,103.0,100.0,92.0,86.0,86.0,87.0,89.0,90.0,88.0,86.0,84.0,80.0,78.0,78.0,80.0,81.0,78.0,71.0,65.0,64.0,65.0,69.0,73.0,77.0,81.0,84.0,83.0,77.0,67.0,54.0,48.0,49.0,56.0,74.0,108.0,129.0,117.0,94.0,88.0,97.0,103.0,107.0,108.0,106.0,102.0,100.0,101.0,106.0,114.0,120.0,125.0,128.0,128.0,125.0,122.0,119.0,119.0,120.0,121.0,121.0,120.0,120.0,120.0,121.0,123.0,125.0,126.0,125.0,122.0,121.0,120.0,120.0,120.0,121.0,121.0,121.0,120.0,119.0,119.0,119.0,120.0,120.0,121.0,121.0,122.0,121.0,121.0,120.0,120.0,120.0,120.0,120.0,120.0,120.0,120.0,120.0,120.0,120.0,120.0,169.0,169.0,170.0,170.0,169.0,169.0,169.0,169.0,169.0,169.0,170.0,172.0,173.0,173.0,173.0,172.0,172.0,171.0,170.0,169.0,169.0,169.0,169.0,169.0,169.0,168.0,167.0,166.0,166.0,166.0,165.0,165.0,164.0,164.0,163.0,161.0,160.0,158.0,157.0,156.0,155.0,154.0,152.0,150.0,142.0,136.0,131.0,129.0,129.0,130.0,134.0,140.0,150.0,159.0,161.0,158.0,151.0,147.0,144.0,144.0,147.0,153.0,156.0,157.0,158.0,158.0,159.0,160.0,162.0,160.0,159.0,159.0,161.0,162.0,165.0,166.0,165.0,165.0,164.0,163.0,162.0,162.0,162.0,163.0,164.0,164.0,166.0,167.0,167.0,165.0,165.0,185.0,210.0,223.0,230.0,228.0,205.0,167.0,158.0,152.0,146.0,144.0,140.0,133.0,127.0,122.0,120.0,120.0,124.0,132.0,144.0,155.0,164.0,172.0,180.0,189.0,198.0,203.0,196.0,186.0,174.0,163.0,155.0,146.0,141.0,139.0,136.0,133.0,127.0,120.0,112.0,93.0,93.0,111.0,131.0,152.0,166.0,177.0,179.0,166.0,141.0,134.0,133.0,136.0,140.0,142.0,144.0,143.0,142.0,139.0,140.0,145.0,150.0,155.0,154.0,150.0,144.0,139.0,136.0,135.0,135.0,136.0,139.0,143.0,150.0,155.0,158.0,159.0,159.0,158.0,157.0,155.0,153.0,151.0,149.0,149.0,148.0,149.0,150.0,152.0,153.0,155.0,156.0,156.0,156.0,155.0,155.0,154.0,154.0,153.0,152.0,151.0,150.0,150.0,151.0,152.0,153.0,153.0,154.0,153.0,118.0,118.0,117.0,115.0,115.0,115.0,116.0,116.0,117.0,117.0,118.0,118.0,119.0,119.0,120.0,120.0,120.0,119.0,119.0,119.0,119.0,119.0,119.0,118.0,118.0,118.0,118.0,120.0,121.0,122.0,123.0,122.0,121.0,121.0,121.0,121.0,122.0,123.0,124.0,126.0,129.0,132.0,134.0,137.0,138.0,138.0,139.0,139.0,141.0,136.0,124.0,101.0,80.0,58.0,44.0,57.0,91.0,111.0,115.0,111.0,109.0,113.0,120.0,121.0,123.0,122.0,119.0,119.0,120.0,124.0,126.0,125.0,124.0,124.0,124.0,125.0,127.0,128.0,128.0,128.0,129.0,130.0,133.0,135.0,136.0,137.0,137.0,135.0,134.0,132.0,134.0,142.0,155.0,151.0,48.0,0.0,155.0,249.0,250.0,213.0,164.0,141.0,125.0,112.0,109.0,122.0,143.0,157.0,155.0,142.0,131.0,123.0,120.0,124.0,128.0,131.0,129.0,126.0,130.0,139.0,142.0,142.0,137.0,133.0,128.0,121.0,111.0,99.0,93.0,104.0,118.0,132.0,141.0,146.0,138.0,122.0,118.0,125.0,122.0,117.0,122.0,134.0,138.0,138.0,136.0,134.0,126.0,115.0,110.0,110.0,109.0,106.0,103.0,103.0,110.0,118.0,124.0,126.0,127.0,125.0,121.0,116.0,114.0,113.0,113.0,115.0,119.0,121.0,122.0,125.0,127.0,126.0,124.0,124.0,122.0,120.0,118.0,117.0,117.0,118.0,118.0,118.0,119.0,119.0,120.0,120.0,120.0,120.0,120.0,120.0,120.0,120.0,119.0,119.0,119.0,120.0,121.0,121.0,121.0,121.0,100.0,100.0,101.0,101.0,101.0,101.0,100.0,99.0,98.0,98.0,97.0,97.0,97.0,97.0,97.0,97.0,98.0,98.0,98.0,99.0,99.0,98.0,98.0,99.0,99.0,99.0,98.0,97.0,96.0,95.0,95.0,95.0,96.0,97.0,97.0,98.0,98.0,98.0,99.0,99.0,100.0,101.0,103.0,107.0,108.0,104.0,99.0,91.0,85.0,82.0,81.0,84.0,94.0,109.0,124.0,128.0,111.0,102.0,90.0,79.0,74.0,78.0,85.0,87.0,88.0,90.0,96.0,98.0,99.0,100.0,97.0,93.0,88.0,85.0,82.0,82.0,85.0,91.0,98.0,106.0,111.0,110.0,105.0,100.0,98.0,99.0,104.0,109.0,114.0,117.0,112.0,97.0,69.0,93.0,161.0,190.0,179.0,133.0,80.0,73.0,74.0,70.0,80.0,91.0,91.0,89.0,88.0,91.0,101.0,111.0,116.0,114.0,111.0,103.0,101.0,103.0,110.0,117.0,115.0,108.0,100.0,93.0,89.0,91.0,100.0,115.0,136.0,160.0,184.0,197.0,191.0,173.0,165.0,160.0,161.0,177.0,193.0,207.0,215.0,211.0,199.0,194.0,188.0,185.0,185.0,188.0,194.0,197.0,195.0,192.0,192.0,194.0,193.0,187.0,174.0,161.0,153.0,150.0,152.0,157.0,163.0,167.0,167.0,166.0,163.0,160.0,159.0,159.0,159.0,159.0,161.0,163.0,164.0,165.0,165.0,165.0,166.0,165.0,164.0,164.0,165.0,165.0,165.0,164.0,164.0,164.0,163.0,162.0,162.0,161.0,161.0,162.0,162.0,163.0,163.0,163.0,163.0,163.0,163.0,163.0,120.0,121.0,121.0,122.0,122.0,122.0,121.0,121.0,120.0,120.0,120.0,119.0,119.0,119.0,119.0,119.0,119.0,119.0,120.0,120.0,120.0,121.0,120.0,120.0,120.0,121.0,121.0,121.0,121.0,122.0,122.0,122.0,122.0,122.0,123.0,124.0,126.0,128.0,130.0,132.0,132.0,131.0,130.0,129.0,128.0,126.0,124.0,125.0,133.0,145.0,153.0,152.0,149.0,143.0,142.0,142.0,139.0,136.0,135.0,135.0,133.0,132.0,132.0,132.0,131.0,131.0,131.0,129.0,126.0,123.0,121.0,119.0,118.0,118.0,117.0,116.0,114.0,113.0,111.0,109.0,107.0,106.0,105.0,104.0,103.0,102.0,102.0,102.0,103.0,104.0,104.0,105.0,113.0,129.0,133.0,122.0,112.0,83.0,83.0,88.0,92.0,91.0,88.0,86.0,82.0,77.0,74.0,75.0,77.0,80.0,85.0,89.0,94.0,95.0,95.0,94.0,94.0,92.0,89.0,84.0,79.0,75.0,73.0,72.0,73.0,75.0,80.0,87.0,93.0,96.0,94.0,89.0,79.0,74.0,83.0,100.0,107.0,103.0,93.0,87.0,88.0,101.0,107.0,110.0,112.0,116.0,118.0,120.0,120.0,121.0,121.0,122.0,122.0,123.0,123.0,123.0,121.0,121.0,123.0,126.0,128.0,130.0,130.0,128.0,127.0,125.0,123.0,121.0,120.0,119.0,118.0,118.0,119.0,119.0,121.0,122.0,123.0,123.0,123.0,122.0,122.0,121.0,121.0,121.0,121.0,121.0,122.0,122.0,122.0,122.0,122.0,123.0,123.0,123.0,123.0,123.0,122.0,122.0,122.0,122.0])
input_data = np.array([102.0,101.0,100.0,100.0,103.0,107.0,111.0,114.0,116.0,118.0,120.0,121.0,121.0,122.0,127.0,135.0,147.0,171.0,201.0,219.0,228.0,232.0,234.0,236.0,236.0,236.0,233.0,231.0,226.0,219.0,207.0,195.0,183.0,170.0,159.0,148.0,137.0,133.0,128.0,124.0,121.0,119.0,120.0,118.0,116.0,113.0,112.0,111.0,109.0,106.0,103.0,101.0,101.0,104.0,107.0,110.0,111.0,114.0,116.0,119.0,121.0,121.0,120.0,120.0,134.0,179.0,207.0,222.0,229.0,233.0,235.0,236.0,236.0,237.0,232.0,226.0,220.0,212.0,202.0,191.0,181.0,168.0,155.0,144.0,137.0,131.0,127.0,124.0,120.0,115.0,110.0,105.0,103.0,102.0,104.0,109.0,112.0,113.0,115.0,116.0,118.0,119.0,120.0,121.0,122.0,123.0,124.0,124.0,125.0,124.0,130.0,138.0,145.0,156.0,194.0,216.0,226.0,213.0,224.0,230.0,233.0,235.0,234.0,227.0,225.0,218.0,205.0,194.0,181.0,167.0,152.0,143.0,135.0,131.0,127.0,122.0,117.0,112.0,110.0,106.0,104.0,102.0,103.0,105.0,106.0,106.0,106.0,108.0,110.0,114.0,116.0,117.0,118.0,119.0,120.0,120.0,121.0,122.0,126.0,125.0,140.0,171.0,202.0,219.0,228.0,232.0,234.0,236.0,236.0,236.0,237.0,235.0,234.0,232.0,227.0,218.0,207.0,195.0,180.0,166.0,154.0,146.0,142.0,137.0,131.0,127.0,125.0,123.0,115.0,107.0,106.0,106.0,105.0,104.0,100.0,98.0,100.0,105.0,109.0,112.0,90.0,94.0,101.0,110.0,122.0,131.0,134.0,135.0,134.0,132.0,127.0,120.0,115.0,119.0,131.0,145.0,132.0,111.0,143.0,159.0,167.0,73.0,49.0,115.0,99.0,82.0,131.0,145.0,151.0,150.0,139.0,129.0,122.0,115.0,111.0,108.0,122.0,151.0,168.0,168.0,145.0,115.0,98.0,88.0,85.0,83.0,77.0,78.0,87.0,101.0,114.0,124.0,130.0,129.0,126.0,121.0,118.0,119.0,126.0,134.0,130.0,127.0,126.0,129.0,145.0,192.0,250.0,121.0,140.0,100.0,80.0,118.0,96.0,73.0,83.0,101.0,122.0,140.0,138.0,114.0,95.0,89.0,95.0,101.0,113.0,129.0,146.0,158.0,163.0,143.0,116.0,102.0,95.0,95.0,98.0,96.0,97.0,98.0,100.0,102.0,105.0,107.0,109.0,110.0,111.0,113.0,109.0,103.0,103.0,114.0,136.0,156.0,134.0,97.0,140.0,166.0,154.0,69.0,67.0,117.0,80.0,61.0,87.0,123.0,141.0,151.0,142.0,123.0,114.0,109.0,104.0,107.0,125.0,151.0,165.0,167.0,143.0,111.0,93.0,96.0,107.0,109.0,106.0,102.0,100.0,102.0,107.0,111.0,113.0,113.0,113.0,112.0,112.0,111.0,108.0,106.0,111.0,118.0,119.0,123.0,117.0,134.0,173.0,141.0,155.0,108.0,73.0,118.0,140.0,108.0,109.0,125.0,136.0,145.0,152.0,147.0,134.0,117.0,100.0,89.0,98.0,114.0,136.0,157.0,166.0,159.0,138.0,106.0,82.0,76.0,86.0,95.0,103.0,107.0,113.0,118.0,125.0,133.0,138.0,139.0,118.0,120.0,121.0,121.0,121.0,120.0,121.0,121.0,122.0,123.0,124.0,125.0,125.0,125.0,125.0,122.0,114.0,91.0,52.0,35.0,61.0,101.0,103.0,95.0,98.0,100.0,97.0,96.0,97.0,98.0,101.0,103.0,104.0,105.0,106.0,108.0,113.0,117.0,120.0,120.0,118.0,114.0,112.0,112.0,113.0,114.0,118.0,121.0,121.0,120.0,120.0,120.0,120.0,119.0,120.0,120.0,120.0,120.0,120.0,120.0,119.0,120.0,124.0,122.0,110.0,79.0,45.0,37.0,67.0,55.0,46.0,75.0,104.0,113.0,109.0,103.0,98.0,96.0,94.0,96.0,100.0,105.0,106.0,105.0,108.0,111.0,115.0,119.0,122.0,119.0,112.0,108.0,108.0,109.0,112.0,117.0,120.0,122.0,122.0,122.0,122.0,122.0,123.0,123.0,124.0,125.0,125.0,125.0,122.0,118.0,119.0,118.0,113.0,97.0,53.0,28.0,71.0,102.0,86.0,80.0,87.0,94.0,96.0,93.0,89.0,87.0,95.0,103.0,107.0,108.0,107.0,108.0,110.0,111.0,112.0,113.0,110.0,108.0,107.0,107.0,108.0,112.0,117.0,122.0,126.0,128.0,128.0,128.0,127.0,126.0,125.0,124.0,124.0,124.0,123.0,121.0,118.0,117.0,119.0,118.0,104.0,74.0,40.0,27.0,82.0,101.0,88.0,90.0,99.0,99.0,93.0,86.0,84.0,83.0,87.0,93.0,99.0,102.0,104.0,105.0,108.0,113.0,119.0,124.0,126.0,126.0,121.0,114.0,108.0,107.0,109.0,111.0,113.0,114.0,115.0,116.0,119.0,122.0,124.0,126.0,106.0,106.0,103.0,100.0,100.0,101.0,101.0,102.0,103.0,103.0,103.0,100.0,94.0,90.0,85.0,92.0,92.0,80.0,59.0,112.0,104.0,132.0,120.0,130.0,117.0,122.0,168.0,177.0,178.0,172.0,165.0,160.0,157.0,157.0,155.0,152.0,150.0,142.0,129.0,121.0,114.0,109.0,104.0,102.0,97.0,91.0,84.0,82.0,81.0,81.0,81.0,84.0,88.0,93.0,97.0,101.0,103.0,103.0,105.0,106.0,113.0,119.0,114.0,103.0,107.0,99.0,96.0,163.0,102.0,135.0,139.0,129.0,105.0,119.0,141.0,166.0,176.0,176.0,173.0,169.0,168.0,166.0,156.0,142.0,133.0,123.0,115.0,108.0,103.0,100.0,102.0,108.0,113.0,114.0,113.0,112.0,110.0,105.0,100.0,96.0,93.0,91.0,90.0,90.0,89.0,87.0,85.0,84.0,81.0,73.0,62.0,73.0,76.0,70.0,47.0,119.0,96.0,132.0,127.0,153.0,163.0,171.0,188.0,194.0,193.0,175.0,163.0,154.0,151.0,148.0,144.0,136.0,124.0,111.0,102.0,97.0,95.0,93.0,92.0,92.0,88.0,84.0,86.0,88.0,88.0,88.0,87.0,87.0,88.0,90.0,92.0,92.0,92.0,93.0,93.0,91.0,92.0,91.0,85.0,91.0,105.0,95.0,84.0,107.0,87.0,116.0,128.0,121.0,112.0,115.0,146.0,169.0,180.0,185.0,181.0,177.0,174.0,174.0,177.0,179.0,178.0,170.0,152.0,134.0,120.0,109.0,99.0,96.0,100.0,106.0,111.0,110.0,106.0,101.0,96.0,91.0,90.0,92.0,95.0,97.0,114.0,113.0,112.0,112.0,112.0,114.0,116.0,119.0,121.0,123.0,127.0,132.0,139.0,150.0,154.0,140.0,127.0,146.0,144.0,79.0,89.0,151.0,180.0,159.0,129.0,123.0,114.0,113.0,121.0,128.0,130.0,130.0,129.0,128.0,127.0,127.0,125.0,127.0,132.0,138.0,148.0,150.0,146.0,139.0,136.0,133.0,131.0,125.0,119.0,114.0,111.0,109.0,109.0,111.0,113.0,114.0,115.0,115.0,112.0,108.0,104.0,107.0,126.0,133.0,116.0,166.0,126.0,68.0,125.0,178.0,171.0,160.0,148.0,126.0,113.0,109.0,106.0,109.0,118.0,124.0,124.0,122.0,121.0,120.0,121.0,123.0,126.0,129.0,131.0,134.0,134.0,131.0,128.0,126.0,123.0,122.0,121.0,121.0,120.0,121.0,121.0,121.0,122.0,122.0,122.0,123.0,126.0,131.0,133.0,140.0,144.0,140.0,140.0,158.0,114.0,58.0,90.0,158.0,193.0,148.0,141.0,132.0,119.0,115.0,120.0,130.0,132.0,131.0,127.0,126.0,126.0,125.0,126.0,130.0,134.0,138.0,144.0,144.0,138.0,129.0,121.0,117.0,115.0,115.0,116.0,116.0,117.0,118.0,120.0,121.0,121.0,121.0,121.0,122.0,123.0,124.0,122.0,124.0,140.0,132.0,120.0,170.0,132.0,72.0,123.0,175.0,194.0,167.0,150.0,134.0,122.0,120.0,123.0,126.0,129.0,131.0,131.0,132.0,131.0,129.0,125.0,125.0,129.0,134.0,138.0,144.0,147.0,145.0,134.0,117.0,111.0,110.0,112.0,114.0,115.0,116.0,116.0,117.0,118.0,120.0,117.0,118.0,118.0,117.0,117.0,118.0,119.0,120.0,122.0,124.0,125.0,126.0,127.0,126.0,125.0,125.0,125.0,115.0,70.0,0.0,65.0,119.0,114.0,115.0,125.0,135.0,133.0,124.0,117.0,115.0,113.0,115.0,119.0,121.0,121.0,123.0,125.0,127.0,127.0,128.0,125.0,121.0,121.0,119.0,117.0,116.0,115.0,117.0,116.0,115.0,115.0,115.0,116.0,118.0,119.0,119.0,119.0,121.0,123.0,126.0,128.0,131.0,135.0,128.0,123.0,118.0,85.0,2.0,45.0,104.0,96.0,92.0,114.0,138.0,146.0,143.0,139.0,136.0,131.0,125.0,126.0,130.0,129.0,126.0,124.0,123.0,124.0,123.0,122.0,117.0,113.0,109.0,106.0,105.0,103.0,103.0,106.0,108.0,110.0,113.0,115.0,117.0,119.0,120.0,123.0,124.0,125.0,127.0,128.0,128.0,128.0,130.0,130.0,125.0,95.0,35.0,68.0,119.0,116.0,116.0,131.0,141.0,142.0,138.0,130.0,126.0,124.0,123.0,127.0,127.0,126.0,125.0,124.0,124.0,123.0,122.0,118.0,115.0,112.0,110.0,107.0,106.0,107.0,110.0,113.0,114.0,115.0,116.0,118.0,121.0,124.0,127.0,129.0,131.0,132.0,133.0,133.0,133.0,134.0,134.0,132.0,125.0,105.0,43.0,54.0,107.0,108.0,95.0,107.0,123.0,129.0,127.0,119.0,112.0,108.0,109.0,113.0,118.0,122.0,122.0,120.0,121.0,126.0,129.0,131.0,131.0,130.0,126.0,120.0,116.0,116.0,115.0,114.0,114.0,112.0,111.0,112.0,114.0,117.0,119.0])
print(input_data.astype)
input_data = input_data.reshape((1,1200))
input_data = input_data.astype(np.float32)

index = input_details[0]['index']
interpreter.set_tensor(index, input_data)
interpreter.invoke()
output_data = interpreter.get_tensor(output_details[0]['index'])
print('output_data:',output_data)

